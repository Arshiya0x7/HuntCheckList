# ğŸ•µï¸ Multi-Brand / Multi-Tenant Pentest Checklist

A practical checklist and methodology for penetration testing **multi-brand / multi-tenant** applications.  
Focus: **tenant isolation, configuration switching risks, cross-tenant privilege escalation, and business logic flaws**.

---

## ğŸ“Œ Overview
Multi-brand apps often share a single codebase with brand-specific configs (e.g., `gamma.nl`, `karwei.nl`).  
Misconfigurations may lead to **data leakage**, **authorization bypass**, or **payment manipulation**.  

This checklist provides **step-by-step tests** to identify such weaknesses.

---

## ğŸ” 1. Recon & Discovery
- [ ] Extract `.js.map` / frontend bundles â†’ search for API URLs, configs, brand IDs  
- [ ] Enumerate supported brands/domains (`gamma.nl`, `gamma.be`, `karwei.nl`)  
- [ ] Check for staging/dev envs (`uat.`, `acc.`, `staging.`)  

---

## âš™ï¸ 2. Config Switching Risks
- [ ] Force brand/country in query â†’ `?brand=gamma&country=BE`  
- [ ] Host header injection â†’ `gamma.nl.evil.com`  
- [ ] Try overriding `formulaConfig` manually in requests  

---

## ğŸ” 3. Authentication & Session Isolation
- [ ] Reuse session cookie from brand A on brand B  
- [ ] Inspect JWT claims for `brand` / `country` tampering  
- [ ] Try login on brand B with brand A credentials  

---

## ğŸ‘¤ 4. Authorization & Access Control
- [ ] Access `/api/karwei/orders/1234` with `gamma` session â†’ IDOR  
- [ ] Modify brand in JWT/request to escalate privileges  
- [ ] Test role drift across tenants  

---

## ğŸ’³ 5. Payment & Checkout Manipulation
- [ ] Add product from `gamma` into `karwei` checkout  
- [ ] Test locale price parsing: `10,00` vs `10.00`  
- [ ] Switch brand mid-checkout â†’ mismatched VAT/tax  

---

## ğŸŒ 6. Locale & Language Switching
- [ ] Force unsupported locales: `?locale=xx_XX`  
- [ ] Check if error messages leak stack traces  
- [ ] Validate currency & input parsing differences  

---

## ğŸ”— 7. API Gateway & CORS
- [ ] Abuse `allowedTracingUrls` (redirect API calls)  
- [ ] Test cross-origin requests â†’ can brand A frontend call brand B API?  

---

## ğŸ“Š 8. Session Replay & Analytics
- [ ] Verify sensitive data not recorded in **Datadog RUM**  
- [ ] Check if staging environments send telemetry to prod accounts  

---

## ğŸš€ 9. Caching & CDN
- [ ] Switch rapidly between brands, compare cached responses  
- [ ] Verify `Vary: Host` header in CDN responses  

---

## ğŸ§© 10. Feature Flags & Business Logic
- [ ] Enable hidden features (e.g., `giftCard=true`)  
- [ ] Call brand A features from brand B APIs  
- [ ] Test for unadvertised discount/payment flows  

---

## ğŸ—ï¸ 11. Deployment & Legacy Endpoints
- [ ] Look for `/api-dev/`, `/acc/api/`, `/staging/checkout`  
- [ ] Check if old endpoints still accept production tokens  

---

## âš¡ 12. Edge-Case Attacks
- [ ] Compare rate-limits across brands  
- [ ] Check password policies per brand (drift risk)  
- [ ] Inspect cross-brand analytics & tracking pixels  

---

## ğŸ“‘ Reporting Guidance
Group issues into categories:
- **Config Switching Risk**  
- **Cross-Tenant Access**  
- **Privilege Escalation**  
- **Payment Manipulation**  
- **Info Disclosure**

> âœ… Always validate issues across multiple brands to demonstrate **systemic risk**.

---

## ğŸ¯ Usage
This checklist is designed for:
- Bug bounty hunters  
- Professional penetration testers  
- Security researchers testing SaaS / e-commerce platforms  

---

### â­ Contribute
Feel free to submit PRs with new test cases or examples from real-world assessments.

